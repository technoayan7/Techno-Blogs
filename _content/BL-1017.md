---
Id: 1017
Title: Important SQL Queries
Author: technoayan
Tags: SQL 
Topic: SQL
Abstract: Top SQL Query Questions for Interviews
HeaderImage: https://i.imgur.com/Zo4VFbE.png
isPublished: true
---

# SQL Queries

### ðŸ’¡ **SQL Queries for Common Employee Data Operations**

---

### 1. **Retrieve the Second-Highest Salary of an Employee**
```sql
SELECT MAX(salary) 
FROM employees 
WHERE salary < (SELECT MAX(salary) FROM employees);
```
---

### 2. **Get the nth Highest Salary**
```sql
SELECT salary 
FROM (SELECT salary, DENSE_RANK() OVER (ORDER BY salary DESC) AS rank 
 FROM employees) AS ranked_salaries 
WHERE rank = N;
```
---

### 3. **Fetch Employees with Salary Greater than the Average Salary**
```sql
SELECT * 
FROM employees 
WHERE salary > (SELECT AVG(salary) FROM employees);
```
---

### 4. **Display the Current Date and Time**
```sql
SELECT CURRENT_TIMESTAMP;
```
---

### 5. **Find Duplicate Records**
```sql
SELECT column_name, COUNT(*) 
FROM table_name 
GROUP BY column_name 
HAVING COUNT(*) > 1;
```
---

### 6. **Delete Duplicate Rows**
```sql
WITH CTE AS (
 SELECT column_name, 
 ROW_NUMBER() OVER (PARTITION BY column_name ORDER BY column_name) AS row_num
 FROM table_name
)
DELETE FROM CTE WHERE row_num > 1;
```
---

### 7. **Get Common Records Between Two Tables**
```sql
SELECT * 
FROM table1 
INTERSECT 
SELECT * 
FROM table2;
```
---

### 8. **Retrieve the Last 10 Records**
```sql
SELECT * 
FROM employees 
ORDER BY employee_id DESC 
LIMIT 10;
```
---

### 9. **Fetch Top 5 Employees with the Highest Salaries**
```sql
SELECT * 
FROM employees 
ORDER BY salary DESC 
LIMIT 5;
```
---

### 10. **Calculate the Total Salary of All Employees**
```sql
SELECT SUM(salary) 
FROM employees;
```
---

### 11. **Find Employees Who Joined in 2020**
```sql
SELECT * 
FROM employees 
WHERE YEAR(join_date) = 2020;
```
---

### 12. **Find Employees Whose Name Starts with 'A'**
```sql
SELECT * 
FROM employees 
WHERE name LIKE 'A%';
```
---

### 13. **Find Employees Without a Manager**
```sql
SELECT * 
FROM employees 
WHERE manager_id IS NULL;
```
---

### 14. **Find Department with the Highest Number of Employees**
```sql
SELECT department_id, COUNT(*) 
FROM employees 
GROUP BY department_id 
ORDER BY COUNT(*) DESC 
LIMIT 1;
```
---

### 15. **Get Count of Employees in Each Department**
```sql
SELECT department_id, COUNT(*) 
FROM employees 
GROUP BY department_id;
```
---

### 16. **Fetch Employees with the Highest Salary in Each Department**
```sql
SELECT department_id, employee_id, salary 
FROM employees AS e 
WHERE salary = (SELECT MAX(salary) 
 FROM employees 
 WHERE department_id = e.department_id);
```
---

### 17. **Update the Salary of All Employees by 10%**
```sql
UPDATE employees 
SET salary = salary * 1.1;
```
---

### 18. **Find Employees Whose Salary is Between 50,000 and 100,000**
```sql
SELECT * 
FROM employees 
WHERE salary BETWEEN 50000 AND 100000;
```
---

### 19. **Find the Youngest Employee**
```sql
SELECT * 
FROM employees 
ORDER BY birth_date DESC 
LIMIT 1;
```
---

### 20. **Fetch First and Last Records from a Table**
```sql
(SELECT * FROM employees ORDER BY employee_id ASC LIMIT 1)
UNION ALL
(SELECT * FROM employees ORDER BY employee_id DESC LIMIT 1);
```
---

### 21. **Find Employees Reporting to a Specific Manager**
```sql
SELECT * 
FROM employees 
WHERE manager_id = ?;
```
---

### 22. **Find the Total Number of Departments**
```sql
SELECT COUNT(DISTINCT department_id) 
FROM employees;
```
---

### 23. **Find Department with the Lowest Average Salary**
```sql
SELECT department_id, AVG(salary) 
FROM employees 
GROUP BY department_id 
ORDER BY AVG(salary) ASC 
LIMIT 1;
```
---

### 24. **Delete All Employees from a Specific Department**
```sql
DELETE FROM employees 
WHERE department_id = ?;
```
---

### 25. **Display Employees Who Have Been in the Company for More than 5 Years**
```sql
SELECT * 
FROM employees 
WHERE DATEDIFF(CURDATE(), join_date) > 1825;
```
---

### 26. **Find the Second-Largest Value in a Table**
```sql
SELECT MAX(column_name) 
FROM table_name 
WHERE column_name < (SELECT MAX(column_name) FROM table_name);
```
---

### 27. **Remove All Records from a Table But Keep the Table Structure**
```sql
TRUNCATE TABLE table_name;
```
---

### 28. **Fetch All Employee Records in XML Format**
```sql
SELECT employee_id, name, department_id 
FROM employees 
FOR XML AUTO;
```
---

### 29. **Get the Current Monthâ€™s Name**
```sql
SELECT MONTHNAME(CURDATE());
```
---

### 30. **Convert a String to Lowercase**
```sql
SELECT LOWER('STRING_VALUE');
```
---

### 31. **Find Employees Who Do Not Have Any Subordinates**
```sql
SELECT * 
FROM employees 
WHERE employee_id NOT IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL);
```
---

### 32. **Calculate Total Sales Per Customer**
```sql
SELECT customer_id, SUM(sales_amount) 
FROM sales 
GROUP BY customer_id;
```
---

### 33. **Check if a Table is Empty**
```sql
SELECT CASE 
 WHEN EXISTS (SELECT 1 FROM table_name) 
 THEN 'Not Empty' 
 ELSE 'Empty' 
END;
```
---

### 34. **Find the Second Highest Salary for Each Department**
```sql
SELECT department_id, salary 
FROM (SELECT department_id, salary, 
 DENSE_RANK() OVER (PARTITION BY department_id ORDER BY salary DESC) AS rank 
 FROM employees) AS ranked_salaries 
WHERE rank = 2;
```
---

### 35. **Fetch Employees Whose Salary is a Multiple of 10,000**
```sql
SELECT * 
FROM employees 
WHERE salary % 10000 = 0;
```
---

### ðŸ’¼ **SQL Queries for Employee Data Operations (Part 2)**

---

### 36. **Fetch Records with Null Values in a Column**
```sql
SELECT * 
FROM employees 
WHERE column_name IS NULL;
```
---

### 37. **Find the Total Number of Employees in Each Job Title**
```sql
SELECT job_title, COUNT(*) 
FROM employees 
GROUP BY job_title;
```
---

### 38. **Fetch Employees Whose Names End with 'n'**
```sql
SELECT * 
FROM employees 
WHERE name LIKE '%n';
```
---

### 39. **Find Employees Who Work in Both Departments 101 and 102**
```sql
SELECT employee_id 
FROM employees 
WHERE department_id IN (101, 102) 
GROUP BY employee_id 
HAVING COUNT(DISTINCT department_id) = 2;
```
---

### 40. **Fetch Employees with the Same Salary**
```sql
SELECT * 
FROM employees 
WHERE salary IN (SELECT salary 
 FROM employees 
 GROUP BY salary 
 HAVING COUNT(*) > 1);
```
---

### 41. **Update Salaries Based on Department**
```sql
UPDATE employees 
SET salary = CASE 
 WHEN department_id = 101 THEN salary * 1.10 
 WHEN department_id = 102 THEN salary * 1.05 
 ELSE salary 
END;
```
---

### 42. **List Employees Without a Department**
```sql
SELECT * 
FROM employees 
WHERE department_id IS NULL;
```
---

### 43. **Find Maximum and Minimum Salary in Each Department**
```sql
SELECT department_id, MAX(salary), MIN(salary) 
FROM employees 
GROUP BY department_id;
```
---

### 44. **List Employees Hired in the Last 6 Months**
```sql
SELECT * 
FROM employees 
WHERE hire_date > ADDDATE(CURDATE(), INTERVAL -6 MONTH);
```
---

### 45. **Display Department-Wise Total and Average Salary**
```sql
SELECT department_id, SUM(salary) AS total_salary, AVG(salary) AS avg_salary 
FROM employees 
GROUP BY department_id;
```
---

### 46. **Find Employees Who Joined in the Same Month and Year as Their Manager**
```sql
SELECT e.employee_id, e.name 
FROM employees e 
JOIN employees m ON e.manager_id = m.employee_id 
WHERE MONTH(e.join_date) = MONTH(m.join_date) 
 AND YEAR(e.join_date) = YEAR(m.join_date);
```
---

### 47. **Count Employees Whose Names Start and End with the Same Letter**
```sql
SELECT COUNT(*) 
FROM employees 
WHERE LEFT(name, 1) = RIGHT(name, 1);
```
---

### 48. **Retrieve Employee Names and Salaries in a Single String**
```sql
SELECT CONCAT(name, ' earns ', salary) AS employee_info 
FROM employees;
```
---

### 49. **Find Employees Whose Salary is Higher than Their Manager's Salary**
```sql
SELECT e.employee_id, e.name 
FROM employees e 
JOIN employees m ON e.manager_id = m.employee_id 
WHERE e.salary > m.salary;
```
---

### 50. **Get Employees Belonging to Departments with Less Than 3 Employees**
```sql
SELECT * 
FROM employees 
WHERE department_id IN (SELECT department_id 
 FROM employees 
 GROUP BY department_id 
 HAVING COUNT(*) < 3);
```
---

### 51. **Find Employees with the Same First Name**
```sql
SELECT * 
FROM employees 
WHERE first_name IN (SELECT first_name 
 FROM employees 
 GROUP BY first_name 
 HAVING COUNT(*) > 1);
```
---

### 52. **Delete Employees Who Have Been in the Company for More Than 15 Years**
```sql
DELETE FROM employees 
WHERE DATEDIFF(CURDATE(), join_date) > 5475;
```
---

### 53. **List Employees Working Under the Same Manager**
```sql
SELECT * 
FROM employees 
WHERE manager_id = ?;
```
---

### 54. **Find the Top 3 Highest-Paid Employees in Each Department**
```sql
SELECT * 
FROM (SELECT *, 
 DENSE_RANK() OVER (PARTITION BY department_id ORDER BY salary DESC) AS rank 
 FROM employees) AS ranked_employees 
WHERE rank <= 3;
```
---

### 55. **List Employees with More Than 5 Years of Experience in Each Department**
```sql
SELECT * 
FROM employees 
WHERE DATEDIFF(CURDATE(), join_date) > 1825;
```
---

### 56. **List Employees in Departments That Have Not Hired Anyone in the Past 2 Years**
```sql
SELECT * 
FROM employees 
WHERE department_id IN (SELECT department_id 
 FROM employees 
 GROUP BY department_id 
 HAVING MAX(hire_date) < ADDDATE(CURDATE(), INTERVAL -2 YEAR));
```
---

### 57. **Find Employees Who Earn More than the Average Salary of Their Department**
```sql
SELECT * 
FROM employees e 
WHERE salary > (SELECT AVG(salary) 
 FROM employees 
 WHERE department_id = e.department_id);
```
---

### 58. **List Managers Who Have More Than 5 Subordinates**
```sql
SELECT * 
FROM employees 
WHERE employee_id IN (SELECT manager_id 
 FROM employees 
 GROUP BY manager_id 
 HAVING COUNT(*) > 5);
```
---

### 59. **Display Employee Names and Hire Dates in the Format "Name - MM/DD/YYYY"**
```sql
SELECT CONCAT(name, ' - ', DATE_FORMAT(hire_date, '%m/%d/%Y')) AS employee_info 
FROM employees;
```
---

### 60. **Find Employees Whose Salary is in the Top 10%**
```sql
SELECT * 
FROM employees 
WHERE salary >= (SELECT PERCENTILE_CONT(0.9) 
 WITHIN GROUP (ORDER BY salary ASC) 
 FROM employees);
```
---

### 61. **Display Employees Grouped by Age Brackets (e.g., 20-30, 31-40)**
```sql
SELECT CASE 
 WHEN age BETWEEN 20 AND 30 THEN '20-30' 
 WHEN age BETWEEN 31 AND 40 THEN '31-40' 
 ELSE '41+' 
 END AS age_bracket, 
 COUNT(*) 
FROM employees 
GROUP BY age_bracket;
```
---

### 62. **Find the Average Salary of the Top 5 Highest-Paid Employees in Each Department**
```sql
SELECT department_id, AVG(salary) 
FROM (SELECT department_id, salary, 
 DENSE_RANK() OVER (PARTITION BY department_id ORDER BY salary DESC) AS rank 
 FROM employees) AS ranked_employees 
WHERE rank <= 5 
GROUP BY department_id;
```
---

### 63. **Calculate the Percentage of Employees in Each Department**
```sql
SELECT department_id, 
 (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM employees)) AS percentage 
FROM employees 
GROUP BY department_id;
```
---

### 64. **Find Employees Whose Email Contains the Domain '@example.com'**
```sql
SELECT * 
FROM employees 
WHERE email LIKE '%@example.com';
```
---

### 65. **Retrieve Year-to-Date Sales for Each Customer**
```sql
SELECT customer_id, SUM(sales_amount) 
FROM sales 
WHERE sale_date BETWEEN '2024-01-01' AND CURDATE() 
GROUP BY customer_id;
```
---

### 66. **Display Hire Date and Day of the Week for Each Employee**
```sql
SELECT name, hire_date, DAYNAME(hire_date) AS day_of_week 
FROM employees;
```
---

### 67. **Find Employees Older Than 30 Years**
```sql
SELECT * 
FROM employees 
WHERE DATEDIFF(CURDATE(), birth_date) / 365 > 30;
```
---

### 68. **Display Employees Grouped by Salary Range (e.g., 0-20K, 20K-50K)**
```sql
SELECT CASE 
 WHEN salary BETWEEN 0 AND 20000 THEN '0-20K' 
 WHEN salary BETWEEN 20001 AND 50000 THEN '20K-50K' 
 ELSE '50K+' 
 END AS salary_range, 
 COUNT(*) 
FROM employees 
GROUP BY salary_range;
```
---

### 69. **List Employees Without a Bonus**
```sql
SELECT * 
FROM employees 
WHERE bonus IS NULL;
```
---

### 70. **Display the Highest, Lowest, and Average Salary for Each Job Role**
```sql
SELECT job_role, MAX(salary) AS highest_salary, MIN(salary) AS lowest_salary, 
AVG(salary) AS avg_salary 
FROM employees 
GROUP BY job_role;
```
---

